<!-- <!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	
	<title>Compatibility Mode</title>

	<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/build/potree/potree.css">
	<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/openlayers3/ol.css">
	<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/spectrum/spectrum.css">
	<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/jstree/themes/mixed/style.css">
</head>

<body> -->

	{% extends 'layouts/base.html' %}

	{% block stylesheets %}
		<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/build/potree/potree.css">
		<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/jquery-ui/jquery-ui.min.css">
		<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/openlayers3/ol.css">
		<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/spectrum/spectrum.css">
		<link rel="stylesheet" type="text/css" href="/static/assets/three/potree-main/libs/jstree/themes/mixed/style.css">
	{% endblock stylesheets %}

	{% block content %}
	<!-- <script src="/static/assets/three/potree-main/libs/jquery/jquery-3.1.1.min.js"></script> -->
	<!-- <script src="/static/assets/three/potree-main/libs/spectrum/spectrum.js"></script> -->
	<!-- <script src="/static/assets/three/potree-main/libs/jquery-ui/jquery-ui.min.js"></script> -->
	
	
	<script src="/static/assets/three/potree-main/libs/other/BinaryHeap.js"></script>
	<script src="/static/assets/three/potree-main/libs/tween/tween.min.js"></script>
	<script src="/static/assets/three/potree-main/libs/d3/d3.js"></script>
	<script src="/static/assets/three/potree-main/libs/proj4/proj4.js"></script>
	<script src="/static/assets/three/potree-main/libs/openlayers3/ol.js"></script>
	<script src="/static/assets/three/potree-main/libs/i18next/i18next.js"></script>
	<script src="/static/assets/three/potree-main/libs/jstree/jstree.js"></script>
	<script src="/static/assets/three/potree-main/build/potree/potree.js"></script>
	<script src="/static/assets/three/potree-main/libs/plasio/js/laslaz.js"></script>
	
	<!-- INCLUDE ADDITIONAL DEPENDENCIES HERE -->
	<!-- INCLUDE SETTINGS HERE -->
	
	<div class="potree_container" style="position: absolute; width: 100%; height: 100vh; left: 0px; top: 0px; z-index: 0;">
	<!-- <div class="potree_container"> -->
		<div id="potree_render_area">
			<input id="timeline" type="range" style="position: fixed; z-index: 3; bottom: 20px; margin-left: 100px;" value="0">
		</div>
		<div id="potree_sidebar_container"> </div>
	</div>
	
	<script type="module">

	import * as THREE from "/static/assets/three/potree-main/libs/three.js/build/three.module.js";
	
		window.viewer = new Potree.Viewer(document.getElementById("potree_render_area"));
		
		viewer.setEDLEnabled(true);
		viewer.setFOV(60);
		viewer.setPointBudget(1_000_000);
		viewer.loadSettingsFromURL();
		
		// viewer.setDescription("Compatibility Mode</br>Go back to: <a href='/index.html'>View Mode</a>");
		
		// function clearScene( scene ) {
			
		// 	scene.remove(scene.getObjectByName('cpms'));

		// 	// scene = new THREE.Scene();

		// 	// scene.addPointCloud( null );

		// 	// while(scene.children.length > 0){ 
		// 	// 	scene.remove(scene.children[0]); 
		// 	// }
		// }

		var loadCount = [1, 0, 0];

		viewer.loadGUI(() => {
			viewer.setLanguage('en');
			$("#menu_appearance").next().show();
			viewer.toggleSidebar();

			var timeline = document.getElementById("timeline");

			timeline.addEventListener( 'change', (event) => {
				let scheduleDay = timeline.value;

				if ( scheduleDay <= 34 ) {

					loadCount[0]++;
					loadCount[1] = 0;
					loadCount[2] = 0;

					// alert('<34');
					if (loadCount[0] === 1) {
						Potree.loadPointCloud("https://mojtaba1995.github.io/clouds/cloud1/cloud.js", "cpms", function(e){
						
							viewer.scene.clearScene();

							viewer.scene.addPointCloud(e.pointcloud);
							
							let material = e.pointcloud.material;
							material.size = 1;
							material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
							
							viewer.fitToScreen();
						});
					}
					
				} else if ( scheduleDay > 34 && scheduleDay <= 67 ) {

					loadCount[0] = 0;
					loadCount[1]++;
					loadCount[2] = 0;

					// alert('34 - 67');
					if (loadCount[1] === 1) {
						Potree.loadPointCloud("https://mojtaba1995.github.io/clouds/cloud2/cloud.js", "cpms", function(e){
						
							viewer.scene.clearScene();

							viewer.scene.addPointCloud(e.pointcloud);
							
							let material = e.pointcloud.material;
							material.size = 1;
							material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
							
							viewer.fitToScreen();
						});
					}
					

				} else {

					loadCount[0] = 0;
					loadCount[1] = 0;
					loadCount[2]++;
					
					// alert('>67');

					if (loadCount[2] === 1) {
						Potree.loadPointCloud("https://mojtaba1995.github.io/clouds/cloud3/cloud.js", "cpms", function(e){
							// clearScene( viewer.scene );
							viewer.scene.clearScene();
							
							viewer.scene.addPointCloud(e.pointcloud);
							
							let material = e.pointcloud.material;
							material.size = 1;
							material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
							
							viewer.fitToScreen();
						});	
					}
					
				}
			} );
		});
		
		// Lion
		Potree.loadPointCloud("https://mojtaba1995.github.io/clouds/cloud1/cloud.js", "cpms", function(e){
			viewer.scene.addPointCloud(e.pointcloud);
			
			let material = e.pointcloud.material;
			material.size = 1;
			material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
			
			viewer.fitToScreen();
		});
		
	</script>
	{% endblock content %}
	
  <!-- </body>
</html> -->
